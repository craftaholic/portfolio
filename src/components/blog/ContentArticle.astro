---
import BackLink from '../ui/BackLink.astro';
import Pill from '../ui/Pill.astro';
import PageContainer from '../layout/PageContainer.astro';
import SharePost from './SharePost.astro';
import MarkdownContent from '../ui/MarkdownContent.astro';
import { formatDate, formatDateTime } from '../../utils/dateFormat';

interface Props {
	title: string;
	description: string;
	tags: string[];
	backLink: {
		href: string;
		label: string;
	};
	/** Use wider container (65rem) for blog posts */
	wide?: boolean;
	/** Publish date for blog posts */
	pubDate?: Date;
	/** Post slug for share links */
	slug?: string;
}

const { title, description, tags, backLink, wide = false, pubDate, slug } = Astro.props;
---

<PageContainer wide={wide}>
	<article class="content-article">
		<BackLink href={backLink.href} label={backLink.label} />

		<header class="header">
			{pubDate && (
				<time class="pub-date" datetime={formatDateTime(pubDate)}>
					{formatDate(pubDate)}
				</time>
			)}
			<h1 class="title">{title}</h1>
			<p class="description">{description}</p>
			<div class="tags">
				{tags.map((t) => <Pill size="sm">{t}</Pill>)}
			</div>
		</header>

		<MarkdownContent>
			<slot />
		</MarkdownContent>

		{slug && <SharePost title={title} slug={slug} />}

		<slot name="after" />
	</article>
</PageContainer>

<style>
	.header {
		margin-top: 1rem;
		margin-bottom: 3rem;
		padding-bottom: 2rem;
		border-bottom: 1px solid var(--gray-800);
	}

	.pub-date {
		display: block;
		font-size: var(--text-sm);
		color: var(--gray-400);
		margin-bottom: 0.5rem;
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	.title {
		font-size: var(--text-2xl);
		color: var(--gray-0);
		margin-bottom: 1rem;
	}

	.description {
		font-size: var(--text-md);
		color: var(--gray-300);
		margin-bottom: 1.5rem;
		line-height: 1.6;
	}

	.tags {
		display: flex;
		gap: 0.5rem;
		flex-wrap: wrap;
	}

	/* Mobile optimizations */
	@media (max-width: 50em) {
		.title {
			font-size: var(--text-xl);
		}

		.description {
			font-size: var(--text-base);
		}

		.tags {
			gap: 0.35rem;
		}
	}

	@media (min-width: 50em) {
		.title {
			font-size: var(--text-3xl);
		}

		.description {
			font-size: var(--text-lg);
		}
	}
</style>
