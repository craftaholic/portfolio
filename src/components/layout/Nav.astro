---
import { SITE } from '../../config';
import Icon from '../ui/Icon.astro';
import type { iconPaths } from '../ui/IconPaths';
import ThemeToggle from '../ui/ThemeToggle.astro';
import Model3DScene from '../three/Model3DScene.astro';

interface Props {
	hideModel?: boolean;
}

const { hideModel = false } = Astro.props;

/** Icon links to social media */
const iconLinks: { label: string; href: string; icon: keyof typeof iconPaths }[] = [
	{ label: 'GitHub', href: SITE.socialLinks[0].href, icon: 'github-logo' },
];
---

<nav>
	<div class="nav-bar">
		<a href="/" class="site-title">
			<Icon icon="code" size="1.4em" />
			{SITE.author}
		</a>
		<div class="nav-actions">
			<div class="socials">
				{
					iconLinks.map(({ href, icon, label }) => (
						<a href={href} class="social" target="_blank" rel="noopener noreferrer">
							<span class="sr-only">{label}</span>
							<Icon icon={icon} />
						</a>
					))
				}
			</div>
			<ThemeToggle />
		</div>
	</div>
	{!hideModel && (
		<div class="model-wrapper" transition:persist="model3d" transition:animate="none">
			<Model3DScene />
		</div>
	)}
</nav>

<style>
	nav {
		view-transition-name: top-nav;
		font-family: var(--font-brand);
		font-weight: 500;
	}

	/* Disable animation for this element during transitions */
	::view-transition-old(top-nav),
	::view-transition-new(top-nav) {
		animation: none;
		mix-blend-mode: normal;
	}

	.nav-bar {
		display: flex;
		justify-content: space-between;
		align-items: center;
		padding: 0.75rem 1rem;
	}

	.model-wrapper {
		max-width: 500px;
		margin: 0 auto;
		padding: 0 1rem;
	}

	.site-title {
		display: flex;
		gap: 0.5rem;
		align-items: center;
		line-height: 1.1;
		color: var(--gray-0);
		text-decoration: none;
	}

	.site-title :global(svg) {
		transition: transform 0.2s ease, color 0.2s ease;
	}

	.site-title:hover :global(svg) {
		transform: scale(1.15);
		color: var(--accent-light);
	}


	.nav-actions {
		display: flex;
		align-items: center;
		gap: 0.5rem;
	}

	.socials {
		--icon-size: var(--text-xl);
		--icon-padding: 0.5rem;
		display: none;
		font-size: var(--icon-size);
	}

	.social {
		display: flex;
		padding: var(--icon-padding);
		text-decoration: none;
		color: var(--accent-dark);
		transition: color var(--theme-transition);
	}

	.social:hover,
	.social:focus {
		color: var(--accent-text-over);
	}

	@media (min-width: 50em) {
		.nav-bar {
			padding: 1rem 1.5rem;
		}

		.site-title {
			font-size: var(--text-lg);
		}

		.socials {
			--icon-padding: 0.375rem;
			display: flex;
			gap: 0;
		}
	}

	@media (min-width: 60em) {
		.nav-bar {
			padding: 1rem 5rem;
		}
	}
</style>
