---
title: Git provider integration
date: 2024-06-20
overview: Implemented GitHub and GitLab integrations for GitOps workflow.
---

## GitOps Foundation

The core of this platform is GitOps: all infrastructure changes are tracked in Git. Today I implemented the Git provider abstraction layer.

## Design

Created a provider interface that works with multiple Git platforms:

```go
type GitProvider interface {
    CreateBranch(repo, branch string) error
    CreatePullRequest(repo, branch, title, body string) error
    MergePullRequest(repo, prNumber int) error
    GetFileContent(repo, path, ref string) ([]byte, error)
    UpdateFile(repo, path, content, message string) error
}
```

## Implementations

**GitHub**
- Uses go-github library
- Personal access token authentication
- Supports both user and organization repos

**GitLab**
- Uses go-gitlab library
- Supports self-hosted GitLab instances
- Project-level tokens supported

## Challenges

The main challenge was handling rate limits gracefully. Both providers have different rate limiting strategies:
- GitHub: 5000 requests/hour with token
- GitLab: 300 requests/minute

Implemented exponential backoff with jitter to handle rate limit responses.

## Testing

Added integration tests using test repositories. The tests create real branches and PRs, then clean up after themselves.
